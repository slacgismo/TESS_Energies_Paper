\section{TESS Standard Design}\label{sec:standard_design}

In the section we focus on the design requirements for a transactive system, as embodied in the Transactive Energy Service System (TESS) platform, and how it differs from other TS designs as employed by previous field deployments. In particular, the TESS design incorporates economic concepts in the design of decentralized mechanisms to enable price discovery, taking into account the opportunity costs and outside options of all participating agents. The fundamental design concepts are coordination through markets in which buyers submit bids and sellers submit offers, with transactions occurring on market platforms. Digitally-enabled devices allow the emergent market-clearing price to be a control signal for autonomous device control and price-based dispatch. 

In its full development a transactive system is intended to comprise multiple retail-level price discovery systems specifically tailored to the needs of the utilities and customer where they are deployed.  This implies the need for a high degree of flexibility regarding which kinds of prices are discovered, the timing and physical extent of the retail market systems, the types of devices that participate, and the manner in which transactions are settled.

The key features of TESS design include all the those found in the original Olympic demonstration, as well as (1) a standardized platform that reveals the full extent of demand-side and DER flexibility, (2) a real-time market operation capable of operating concurrently at multiple time-scales, and (3) a flexible settlement mechanism that supports brownfield deployments, among other things. The standard TESS design takes a modular approach that addresses the full life cycle of a transaction deployment, starting from program screening, financing and engineering design, through participant recruiting, system provisioning, hardware and software commissioning, all the way through to retail, wholesale, and settlement operations. This modularity allows many different kinds of utility operations to be supported using the same system infrastructure, significantly reducing the barriers to adoption and the cost of deployment.  The information systems support a wider range of capabilities such that any  bidding function is permitted, instead of the ``approved'' functions used in the Olympic and subsequent transactive system demonstrations. Accommodating heterogeneous bidding functions reflects the subjective nature of preferences and opportunity costs and enables a more decentralized platform that gives utilities, device manufacturers, and consumers more flexibility and autonomy than previously possible in transactive systems.

Section \ref{sec:technical_setup} describes the technical setup of the TESS platform, Section \ref{sec:price_discovery} defines how the TESS design enables price discovery, and Section \ref{sec:time_scales} delineates the challenges of markets at different time scales and how the TESS design addresses those challenges. Section \ref{sec:devices} highlights a distinctive feature of the TESS design, the variety of devices that can participate and their bidding functions. Section \ref{sec:settlement} describes the TESS approach to financial settlement of transactions.

\subsection{Technical Setup}\label{sec:technical_setup}

The general architecture of TESS largely follows the standard design of TS, and the HCE project is deploying the technical aspects of TESS.\footnote{Documentation and code for TESS are available at \url{https://github.com/slacgismo/TESS}.} The market integration with the distribution system requires the following steps:

\begin{itemize}
    \item Register customers and their devices in the TESS database
    \item Set up utility operation requirements in TESS database
    \item Replicate customers and their devices in the cloud where TESS is running
    \item Coordinate retail operations with wholesale operations
    \item Operate the retail market
    \item Settle the financial outcomes periodically
\end{itemize}

Each customer has a home hub that manages the settings and actions of its devices on the customer's behalf. At each market interval, the agents representing the home hubs on the cloud update their physical states based on the information available on the TESS database. In particular, this physical state information is measured by the meter or other relevant sensors and recorded. Based on this information, the agents form dispatch bids, i.e., how much they are willing to pay for consumption or the minimum price for supply. 
The agent representing the retailer submits wholesale market supply, with the price bid corresponding to the cost of supply and the quantity bid to the import capacity. This coordination with wholesale operations is essential to ensuring that the utility is maximizing the utilization of the wholesale agreements it has in place.

Shortly before the beginning of the market interval, the market operator agents collects all bids and determines the market result by constructing market demand and supply for that interval. The market is cleared in a welfare-maximizing way, where quantity supplied equals quantity demanded. The result is characterized by an equilibrium price and the share of the marginal bid. The latter equals one if the marginal bid (i.e. the bid(s) that determine the market price) can be fully cleared and is between 0 and 1 if that is not the case. For instance, if solar systems are generating more than can be exported, the bid will only partially clear and solar systems must reduce their generation to, for instance, 80\%. All agents are implemented on the cloud and values (measurements, bids, market results) are stored in the TESS database.

After market clearing, home hubs compare their devices' bids to the equilibrium price. If the bid price exceeds the equilibrium price (for demand) or is less (for supply), the bid was cleared. If price and bid are equal, the bid is partially cleared, for a share of $\alpha \in (0,1)$. This information is picked up by the device API and implemented physically.

Periodically the utility must settle the accumulated account balances with all the participants in the transactive system.  TESS completes this process in two steps. First all the unsettled transactions are summed up for each participant.  The utility then computes the total costs and revenues of TESS operations, to determine the net benefit of operating TESS during the settlement period.  The suitably chosen portion of total net benefit, e.g., 50\%, is then divided among all the participant \textit{pro rata} their net transactions for the period.  For example, if Alice earned \$100 during the period, and Betty earned \$50, then if the utility saw a net benefit of \$30, the payment to Alice would be \$110, and the payment to Betty would be \$55, and keep the remaining \$15. Note that this net benefit may be negative number, in which case it would reduce the participant payments in a similar manner. In addition, some participants may have negative payments, i.e., costs, in which case the credit may be offset those debits. 

\subsection{TESS Design: Price Discovery Mechanisms}\label{sec:price_discovery}

Price discovery occurs through the interaction of demand bids and supply offers on the market platform. The double clock auction mechanism is a key feature of standard transactive system design, and in this design dimension TESS is similar to other transactive systems. Most transactive systems are currently designed to discover energy prices per MWh, i.e., bid quantities in a given time period are measured in MW.  The analogy to wholesale energy market is obvious, insofar as transactive systems are often designed to mitigate distribution constraints.

However, the bidding strategies for some resources can be difficult to design for an energy-only retail market. For example, in the Olympic project, diesel generators had a very complex bidding strategy because of the 100 hour annual maximum run-time license.  In addition, there are potential issues with incentive compatibility when using thermostatic devices if consumers are given too much direct control over the bidding strategy \citep{li2020transactive}. High degrees of automation not only ensured strong demand response resource participation, but also protected against strategic bidding practices that could undermine the design objectives of the mechanism.

In addition, TESS differs from the transactive system demonstrated earlier because it does not standard the bidding strategies employed by difference classes of devices.  Instead, device manufacturers and third-party agent developers are free to offer any number of bid strategies from which the consumer can choose.  Bid function heterogeneity is an important and distinctive feature of TESS that improve price stability, and makes it difficult for one type of device or vendor to exercise any kind of market power.

As more DERs enter the resource mix, particularly zero marginal cost resources, changing market design away from transacting energy may be useful. Three different resource attributes and their prices are mathematically related: energy prices (\$/MWh), storage prices (\$/MWh$^2$), and ramping prices (\$/MW) \citep{chassin2017thesis}. TESS is designed to support these three distinct price discovery mechanisms simultaneously. At the time of this writing, these are beyond scope of the standard transactive design and are topics for further research.

\subsection{TESS Design: Time and Size Scales}\label{sec:time_scales}

The double auction used on most existing transactive projects has important limitations that TESS seeks to overcome in its design, including the inability to clear resources that can act significantly faster than the auction interval, which is typically 5 minutes. TESS allows an operator-specified market clearing interval, although the default is still 5 minutes. 

It is also difficult, if not impossible, to reveal any forward knowledge through the real-time double auction  mechanism, which precludes agents from making mutually beneficial forward commitments. To address these problems, the TESS design includes an order book mechanism that accepts two types of bids: market orders and limit orders. A market order allows a resource to dispatch immediately at the current price, whatever it is. A limit order allows a resource to be reveal its dispatch capabilities for any future time interval, contingent on a suitable ask or offer price.

The physical scaling of a transactive system can also be a difficult design and implementation problem for utilities, although usually it is not a problem. For example, in the Columbus demonstration project \citep{Widergren2014} the standard transactive system was deployed on 4 feeders without significant changes to the implementation.  However, the Pacific Northwest project \citep{hammerstrom2015pacific} encountered a number of important market design and operation issues that emerged due the need to coordinate the dispatch of retail resources across 11 utilities in a region without restructured electricity markets.

TESS continues to focus on retail-level pricing mechanisms, but does not focus exclusively on using energy prices (\$/MWh) to manage distribution system constraints.  As mentioned in \ref{sec:teecon}, TESS is designed to permit discovery of other prices, such as storage prices (\$/MW$^2$) or ramping prices (\$/MW) that can be used to provide signals that can incentivize changes to the state of charge objective of a battery or the power setting of an inverter, respectively.  However, these prices signals have yet to be studied in detail in simulations or demonstrated in the field, and will be subject of future projects.

\subsection{TESS Design: Types of Participating Devices}\label{sec:devices}

TESS enables a wide variety of resources to participate in the market, with custom bidding functions that can communicate both the technical capabilities of the resource and the preferences and opportunity costs of the owner.

In the standard design piloted by the Olympic project, thermostat heating/cooling devices, diesel generators, micro-turbines, white goods appliances, and municipal water pumping systems were the principal resources that could place bids and offers in the retail market.  At the time, these were the typical devices utilities hoped to dispatch using a retail real-time energy price. 

The bidding strategies they used were selected by the system engineers, and not by the vendors or users of the devices. This design choice was necessary given the lack of experience with transactive systems, if only to ensure that the system functioned properly. The system designers recognized that ultimately the bidding strategies are the more important part of the system and the design, and selection of these strategies was a task that ought to be left to the device manufacturers and consumers.

The TESS design brings this notion to full realization by allowing devices to implement their own bidding strategies, and giving consumers more direct control over the settings that govern those strategies.  More recently, new types of flexible DERs figure prominently in utility distribution system operations. For example, consumers can control their battery storage resource strategy by changing the preferred energy reserve and its sensitivity to price fluctuations.  Similarly, electric vehicles can be configured to charge more aggressively, ignoring prices fluctuations, or more economically by charging only when the price is low and plenty of time remains before the state-of-charge objective must be met (\cite{behboodi2016electric}). 

The most significant distinctive feature of TESS relative the previous transactive system implementations is that these bidding strategies are not developed by the system designers and can be replaced by any strategy that meets the minimum requirements of either the double clock auction or the order book, i.e., demand or supply quantity and reservation price.  In the case of order books, there is also a time dimension that must be included, and absent a price, the bid is considered simply a market order and the price of the next available resource is taken.  The TESS design also anticipates the emergence of AI bidding agents, where learning and forecasting functionalities are included. This development is expected to bring additional diversity in the bidding strategies and add to the overall resilience and stability of the transactive system by avoiding many adverse ``flocking'' behaviors and resulting price volatility observed in the previously demonstrated transactive systems.

\subsection{TESS Design: Settlement Mechanisms}\label{sec:settlement}

While demand and supply coordinate in real time through a transactive system, the accounting to reconcile financial flows with transactions often takes place later (e.g., monthly). Several financial settlement systems have been demonstrated in previous transactive systems, including a side-payment mechanism \citep{hammerstrom_2008} and a regulator-approved tariff \citep{Widergren2014}. TESS proposes two additional settlement systems based on tokens, supporting these approaches to settlement in the same manner they were implemented previously. In addition, TESS introduces a token or coin settlement system to permit the use of new digital or crypto-currencies, if desired.

The first approach is useful in situations where demand and DER flexibility yields a system benefit, such as discharging a battery to reduce bulk power consumption during a wholesale coincident peak hour. This approach uses cooperative game theory concepts about dividing a co-created benefit, and develops an indirect approach to performing a Shapley value calculation to implement that allocation. A certain number of tokens are issued each month by the utility based on the expected value of the total welfare surplus from operations. Customers then participate in the transactive system using these tokens, so their token balances reflect their decisions and actions. At the end of the month the total surplus is calculated and used to assign a value to the tokens. Each participant is then compensated according to how many tokens they hold and their individual bill credits awarded accordingly.

The advantages of this approach are two-fold. First, the utility is not committed to compensating consumers more than the total net benefit arising from their collective behavior. In particular, if consumers exhibit a short-term behavior that is highly profitable to them but has a longer-term negative system impact, this will be revealed in reduced token values and diminish the strength of the near-term incentives relative to the long-term benefits.  Second, the calculation methods ensure that all parties are compensated fairly for their marginal contributions to the total net benefit, i.e., a consumer whose actions increased the total surplus greater will see a larger reward than one whose actions were detrimental. Actions that are both individually and collectively beneficial are rewarded the most, and ones harmful to both are rewarded the least, while those that only benefit one or the other are rewarded somewhere in between.  

However, this approach may be deemed too risky by some utilities. In addition, some uncertainty remains regarding whether a token-based settlement mechanism might run afoul of government financial regulations. This concern required the development of a second financially equivalent mechanism, wherein customers bid using the local currency and at the end of the billing cycle, all participants are charged a share of the total cost of operating the system in proportion to their net earnings under the transactive system. The result of this calculation is the same as the one described above. However, the perception of consumers may be significantly different, which is a question for further research. 

Ultimately, TESS provide multi-level market integration, from retail to feeder to wholesale. As a platform for implementing transactive energy systems, the TESS mechanisms described here are only part of a whole-of-operation approach to integrating distributed energy resources into the utility operation.  TESS also includes program development tools such as screening, financing, and engineering software, deployment tools such as participant identification, recruitment, enrollment, and bootstrapping products, as well as system operations tools such as wholesale, distribution, and settlement products needed to give the utility all the resources needed to successful implement a transactive system.

